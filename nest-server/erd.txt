# Visualize on https://erd.surge.sh
# or https://quick-erd.surge.sh
#
# Relationship Types
#  -    - one to one
#  -<   - one to many
#  >-   - many to one
#  >-<  - many to many
#  -0   - one to zero or one
#  0-   - zero or one to one
#  0-0  - zero or one to zero or one
#  -0<  - one to zero or many
#  >0-  - zero or many to one
#
////////////////////////////////////


user
----
id integer PK
username varchar(32) unique
fullName varchar(32) 
hkId varchar(8) unique
email varchar(255) unique
card varchar(16) unique null
public_key char(64) unique null
hk_phone varchar(8) unique
human_verification boolean null
cv_upload varchar(255) null
description text null


job_comment
-----------
id integer PK
job_id integer FK >0- job.id
user_id integer FK >0- user.id
score integer
remark text


job
---
id integer PK
user_id integer FK >- user.id
title varchar(255)
description text
price integer
type enum('demand','offer')


job_tag
-------
id integer PK
job_id integer FK >0- job.id
tag_id integer FK >0- tag.id


tag
---
id integer PK
name text unique


bookmark
--------
id integer PK
buyer_user_id integer FK -< user.id
seller_user_id integer FK -< user.id
created_at timestamp
updated_at timestamp
job_id integer FK -0< job.id


contract
--------
id integer PK
buyer_user_id integer FK >- user.id
seller_user_id integer FK >- user.id
start_time timestamp
estimated_finish_time timestamp
claim_finish_time timestamp NULL
confirm_finish_time timestamp NULL
reject_finish_time timestamp NULL
cancel_time timestamp NULL
cancel_by_user_id integer NULL FK >0- user.id
estimated_payment_release_time timestamp
system_receive_payment_id integer NULL FK >0- transaction.id
system_send_payment_id integer NULL FK >0- transaction.id
job_id integer FK - job.id


transaction
-----------
id integer PK
amount integer
user_id integer FK >0- user.id
direction enum('from_system','to_system')


chat_message
------------
id integer PK
contract_id integer FK >0- contract.id
user_id integer FK >0- user.id
content integer


# zoom: 0.737
# view: (115, 35)
# text-bg: #6495ed
# text-color: #000000
# diagram-bg: #f5f5f5
# diagram-text: #f5f5f5
# table-bg: #ffffff
# table-text: #000000
# user (645, 44)
# job_comment (413, 399)
# job (779, 344)
# job_tag (438, 680)
# tag (821, 647)
# bookmark (287, 101)
# contract (1167, 126)
# transaction (1196, 628)
# chat_message (1019, -24)